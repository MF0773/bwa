گزارش تغییرات کد (خلاصه و دلیل)

1) جلوگیری از دسترسی خارج از محدوده در زنجیره‌بندی دانه‌ها
   - فایل: cuda/bwamem_GPU.cu
   - تغییر: قبل از ساخت زنجیره، اگر seed_a[i].rid نامعتبر باشد (کمتر از صفر یا بزرگ‌تر/مساوی تعداد رفرنس‌ها) آن seed نادیده گرفته می‌شود.
   - دلیل: compute-sanitizer خطای out-of-bounds را روی d_bns->anns[seed_a[i].rid] گزارش می‌داد. این guard جلوی کرش و دسترسی غیرمجاز را می‌گیرد و فقط seedهای نامعتبر را حذف می‌کند.

2) انتقال ماتریس امتیازدهی به حافظه constant
   - فایل‌ها: cuda/ksw_CUDA.cu ، cuda/streams.cu
   - تغییر: تعریف d_scmat[25] در constant memory و استفاده از آن در score() زمانی که m==5 (DNA).
             همچنین در زمان انتقال تنظیمات، opt->mat با cudaMemcpyToSymbol به d_scmat کپی می‌شود.
   - دلیل: ماتریس امتیازدهی بسیار کوچک است (۵×۵) و با قرار گرفتن در constant cache، دسترسی سریع‌تر و broadcast بهتری برای همه تردها می‌دهد و فشار روی global memory را کم می‌کند.

3) استفاده از __ldg برای خواندن‌های فقط‌خواندنی
   - فایل: cuda/ksw_CUDA.cu
   - تغییر: در حلقه‌های داغ، target[i] و query[j] با __ldg خوانده می‌شوند و در score() (وقتی m!=5) نیز mat با __ldg خوانده می‌شود.
   - دلیل: __ldg مسیر read-only cache را فعال می‌کند تا دسترسی‌های پرتکرار، کش‌پذیرتر شوند و احتمالاً کارایی بهتر شود، بدون تغییر در منطق الگوریتم.

نکته:
این تغییرات منطق امتیازدهی را تغییر نمی‌دهند؛ فقط الگوی دسترسی حافظه را بهینه می‌کنند. تغییر شماره 1 فقط برای جلوگیری از دسترسی غیرمجاز است و seedهای با rid نامعتبر را حذف می‌کند.
